# é¡¹ç›®æ¦‚è§ˆ

## ğŸ§© åŠŸèƒ½æ¨¡å—

### ä¸ªäººåº“
- ç™»å½•åæ–°å¢ã€ç¼–è¾‘ã€åˆ é™¤ã€æ¸…ç©ºè‡ªå·±çš„ç‚¹ä½
- æ”¯æŒåˆ†äº«åˆ°å…±äº«åº“

### å…±äº«åº“
- æŸ¥çœ‹ä»–äººåˆ†äº«çš„ç‚¹ä½
- æ”¯æŒå¤åˆ¶åˆ°ä¸ªäººåº“ï¼ˆå·²åœ¨å‰ç«¯åšé˜²é‡ï¼ŒåŒä¸€å…±äº«ç‚¹ä½åŒä¸€ç”¨æˆ·åªä¿å­˜ä¸€ä»½ï¼‰

### åœ°å›¾ä¸ç‚¹ä½
- `Leaflet` åœ°å›¾æ ‡æ³¨ç«™ä½/ç„ç‚¹/è½ç‚¹
- æŒ‰åœ°å›¾ã€è‹±é›„ã€é˜µè¥ã€æŠ€èƒ½ç­›é€‰ä¸æŸ¥çœ‹

### åˆ†äº«
- ç”ŸæˆçŸ­ `share_id` å†™å…¥å…±äº«è¡¨
- å…±äº«æ•°æ® 15 å¤©æ¸…ç†æç¤º

### è®¤è¯
- æ¸¸å®¢æ¨¡å¼ï¼ˆä»…æŸ¥çœ‹/åˆ†äº«ï¼‰
- ç™»å½•æ¨¡å¼ï¼ˆå¯å¢åˆ æ”¹ï¼‰

### ä½œè€…ä¿¡æ¯
- æ”¯æŒä» B ç«™å’ŒæŠ–éŸ³è§†é¢‘é“¾æ¥è‡ªåŠ¨è·å–ä½œè€…å¤´åƒã€æ˜µç§°ã€ä¸»é¡µé“¾æ¥
- ä½¿ç”¨ Supabase Edge Function `get-video-author` ç»•è¿‡ CORS é™åˆ¶

## ğŸ—ï¸ å‰ç«¯æ¶æ„ä¸æ•°æ®æµ

### çŠ¶æ€ä¸é€»è¾‘
`React hooks` ç®¡ç†ï¼š
- `useValorantData` - æ‹‰å–åœ°å›¾/è‹±é›„
- `useLineups` - è·å–ä¸ªäººåº“
- `useSharedLineups` - è·å–å…±äº«åº“
- `useShareActions` - å¤„ç†åˆ†äº«/å¤åˆ¶
- `useLineupActions` - åš CRUD

### åœ°å›¾å±•ç¤º
- `components/LeafletMap` - æ¸²æŸ“ç‚¹ä½ä¸æ ‡æ³¨

### åˆ—è¡¨ä¸é¢æ¿
- `LeftPanel` - é€‰æ‹©åœ°å›¾/ç­›é€‰
- `RightPanel` - ç®¡ç†åˆ—è¡¨ä¸æ“ä½œ

### æ¨¡æ€æ¡†
- é¢„è§ˆã€ç¼–è¾‘å™¨ã€æŸ¥çœ‹å™¨ã€åˆ é™¤ç¡®è®¤ã€åœ°å›¾é€‰æ‹©ç­‰ç»„ä»¶

### æ•°æ®å­˜å‚¨
`Supabase` ä¸¤å¥—åº“ï¼š
- ä¸»åº“ï¼š`valorant_lineups` / `valorant_users`
- å…±äº«åº“ï¼š`valorant_shared`
- `src/supabaseClient.ts` åˆ›å»ºä¸»åº“ä¸å…±äº«åº“å®¢æˆ·ç«¯

## ğŸ“Š å…³é”®æ•°æ®/è¡¨

### ä¸ªäººåº“ `valorant_lineups`
å­—æ®µåŒ…å«ï¼š
- `user_id` - ç”¨æˆ· ID
- åœ°å›¾/è‹±é›„/æŠ€èƒ½ä¿¡æ¯
- å›¾ç‰‡æè¿°
- `cloned_from` - æ¥æºå…±äº«ç‚¹ä½ id
- `source_link` - è§†é¢‘æ¥æºé“¾æ¥
- `author_name` / `author_avatar` / `author_uid` - ä½œè€…ä¿¡æ¯

### å…±äº«åº“ `valorant_shared`
å­—æ®µåŒ…å«ï¼š
- `share_id` - çŸ­é“¾æ¥ ID
- `source_id` - æ¥æºç‚¹ä½ ID
- ä¸ç‚¹ä½å†…å®¹å­—æ®µ

å‰ç«¯å·²åœ¨ä¿å­˜åˆ°ä¸ªäººåº“æ—¶é˜²é‡æ£€æŸ¥ `(user_id, cloned_from)`ã€‚

## ğŸ“Š ä»£ç†äººä¸æŠ€èƒ½æ•°æ®

### æ•°æ®æ¥æº
`useValorantData` è°ƒç”¨ï¼š

```
https://valorant-api.com/v1/agents?language=zh-CN&isPlayableCharacter=true
```

ä½¿ç”¨è¿”å›çš„ `displayName`ã€`displayIcon`ã€`abilities`ã€‚

### æŠ€èƒ½æ§½ä½
ç»Ÿä¸€æŒ‰ `C / Q / E / Xï¼ˆAbility1 / Ability2 / Grenade / Ultimateï¼‰` é¡ºåºå±•ç¤ºï¼Œ`abilityIndex` å¯¹åº” `0/1/2/3` ã€‚

### æœ¬åœ°è¦†ç›–
`src/data/ability_overrides.json` ä»¥ä»£ç†äººä¸­æ–‡åæˆ–è‹±æ–‡åä¸ºé”®ï¼Œæä¾›æŠ€èƒ½å›¾æ ‡ä¸ä¸­æ–‡æ ‡é¢˜è¦†ç›–ã€‚

`src/utils/abilityIcons.ts` ä¼˜å…ˆä½¿ç”¨è¦†ç›–ï¼Œå†å›é€€æ¥å£çš„ `displayIcon`ã€‚

### è¿‡æ»¤è§„åˆ™
è¢«åŠ¨æŠ€èƒ½ï¼ˆ `slot` ä¸º `Passive` ï¼‰åœ¨ `getAbilityList` ä¸­è¢«è¿‡æ»¤ï¼Œä¸å‚ä¸ç´¢å¼•ä¸å±•ç¤ºã€‚

### é»˜è®¤é€‰ä¸­
è‹±é›„åˆ—è¡¨æŒ‰åç§°æ’åºåé»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªè‹±é›„ã€‚

## ğŸ“‚ ç›¸å…³ä»£ç ä½ç½®

### æ•°æ®è·å–
- `src/hooks/useValorantData.ts` - åœ°å›¾/è‹±é›„
- `src/hooks/useLineups.ts` - ä¸ªäººåº“
- `src/hooks/useSharedLineups.ts` - å…±äº«åº“

### åˆ†äº«/å¤åˆ¶
- `src/hooks/useShareActions.ts` - åˆ†äº«åˆ°å…±äº«è¡¨ã€å¤åˆ¶åˆ°ä¸ªäººåº“é˜²é‡

### ä½œè€…ä¿¡æ¯
- `src/utils/authorFetcher.ts` - è°ƒç”¨ Edge Function
- `src/components/EditorModal.tsx` - è‡ªåŠ¨è·å–ä¸æ‰‹åŠ¨åˆ·æ–°
- `src/components/ViewerModal.tsx` - æ˜¾ç¤ºä½œè€…ä¿¡æ¯ä¸ä¸»é¡µè·³è½¬

### å›¾æ ‡ä¸æ–‡æ¡ˆ
- `src/utils/abilityIcons.ts`
- `src/data/ability_overrides.json`

### å¸¸é‡
- `src/constants/maps.ts` - åœ°å›¾ç¿»è¯‘ä¸è‡ªå®šä¹‰ URL
- `src/services/tables.ts` - è¡¨å

### å¤–éƒ¨æŠ“å–è„šæœ¬
`scripts/fetchAbilities.cjs` é€šè¿‡ `https://api.val.qq.com` çš„ GraphQL æ¥å£æŠ“å–è‹±é›„æŠ€èƒ½å›¾æ ‡/åç§°ï¼Œç”Ÿæˆ `src/data/ability_overrides.json`ï¼ˆä»…æœ¬åœ°è¿è¡Œè„šæœ¬æ—¶ç”Ÿæ•ˆï¼Œçº¿ä¸Šè¿è¡Œæ—¶ä»ä½¿ç”¨ä»“åº“å†…çš„ JSONï¼‰ã€‚
